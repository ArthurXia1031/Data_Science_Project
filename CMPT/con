import snowflake.connector
import os

# 1. é…ç½®è¿æ¥
conn = snowflake.connector.connect(
    user='YOUR_USERNAME',
    password='YOUR_PASSWORD',
    account='YOUR_ACCOUNT_IDENTIFIER',  # e.g., xy12345.us-east-1
    warehouse='YOUR_WAREHOUSE',
    database='YOUR_DATABASE',
    schema='YOUR_SCHEMA'
)

# 2. è®¾ç½®æœ¬åœ°ä¿å­˜è·¯å¾„
# æ³¨æ„ï¼šWindows è·¯å¾„éœ€è¦è½¬ä¹‰ï¼Œä¾‹å¦‚ 'C:\\data\\edges\\'
local_path = '/tmp/data/edges/' 
if not os.path.exists(local_path):
    os.makedirs(local_path)

# 3. æ‰§è¡Œ GET å‘½ä»¤
# è¿™é‡Œçš„ @~/gnn_export/edges/ å¿…é¡»å’Œä½  SQL é‡Œ COPY INTO çš„è·¯å¾„ä¸€è‡´
sql_get = f"GET @~/gnn_export/edges/ file://{local_path}"

print("ğŸ“¥ å¼€å§‹ä¸‹è½½ Parquet æ–‡ä»¶...")
cursor = conn.cursor()
cursor.execute(sql_get)

# 4. æ‰“å°ä¸‹è½½ç»“æœ
for (file, size, status, encryption) in cursor:
    print(f"File: {file}, Size: {size} bytes, Status: {status}")

print("âœ… ä¸‹è½½å®Œæˆï¼")
cursor.close()
conn.close()
